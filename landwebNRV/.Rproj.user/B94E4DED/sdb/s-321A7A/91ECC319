{
    "contents" : "rm(list=ls())\nlibrary(data.table)\nlibrary(dplyr)\nlibrary(rgdal)\nlibrary(sp)\nlibrary(raster)\nworkPath <- \"~/GitHub/landwebNRV\"\nload(file.path(workPath, \"alldata_purified.RData\"))\nsource('~/GitHub/landwebNRV/landwebNRV/R/standardizeSpeciesName.R')\nsource('~/GitHub/landwebNRV/landwebNRV/R/biomassCalculation.R')\nsource('~/GitHub/landwebNRV/landwebNRV/R/speciesDominanceIdentification.R')\nsource('~/GitHub/landwebNRV/landwebNRV/R/UTMtoLongLat.R')\n# gethering plot header data\nallPlotHeaderData <- ABPSPoutput$plotHeaderData\nallPlotHeaderData[,Northing:=as.numeric(Northing)]\nallPlotHeaderData <- rbind(allPlotHeaderData, BCPSPoutput$plotHeaderData)\nallPlotHeaderData <- rbind(allPlotHeaderData, MBPSPoutput$plotHeaderData)\nallPlotHeaderData <- rbind(allPlotHeaderData, MBTSPoutput$plotHeaderData)\nallPlotHeaderData <- rbind(allPlotHeaderData, NFIPSPoutput$plotHeaderData)\nallPlotHeaderData <- rbind(allPlotHeaderData, NWTTSPoutput$plotHeaderData)\nallPlotHeaderData <- rbind(allPlotHeaderData, SKPSPoutput$plotHeaderData)\nallPlotHeaderData <- rbind(allPlotHeaderData, SKTSP_Mistik_output$plotHeaderData[\n  , ':='(Easting = Easting*10000, Northing = Northing*10000)])\nallPlotHeaderData <- rbind(allPlotHeaderData, SKTSP_PPPA_output$plotHeaderData)\nallPlotHeaderDataLongLat <- allPlotHeaderData[!is.na(Longitude) & Longitude!=0, ]\nprint(range(allPlotHeaderDataLongLat$Longitude))\nprint(range(allPlotHeaderDataLongLat$Latitude))\nallPlotHeaderDataNoLongLat <- allPlotHeaderData[!(MeasureID %in% allPlotHeaderDataLongLat$MeasureID),]\nprint(range(allPlotHeaderDataNoLongLat$Zone))\nprint(range(allPlotHeaderDataNoLongLat$Easting))\nprint(range(allPlotHeaderDataNoLongLat$Northing))\nallPlotHeaderDataNoLongLat <- UTMtoLongLat(UTMTable = allPlotHeaderDataNoLongLat)$Transformed\n\nallPlotHeaderDataLongLat <- rbind(allPlotHeaderDataLongLat, allPlotHeaderDataNoLongLat)\n\n\n# working on AB PSP\nABPSPtreeData <- ABPSPoutput$treeData\nABPSPtreeData <- standardizeSpeciesName(ABPSPtreeData, forestInventorySource = \"ABPSP\")\n# nrow(ABPSPtreeData[newSpeciesName == \"unknown\",]) # 0\nABPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\n# unique(ABPSPtreeData[Biomass==0,]$newSpeciesName)\n# limber pine whitebark pine\n# for these two species, using softwood equation\nABPSPtreeData[newSpeciesName == \"limber pine\" | newSpeciesName == \"whitebark pine\",\n              newSpeciesName:=\"softwood\"]\n\nABPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\n# unique(ABPSPtreeData[Biomass==0,]$newSpeciesName)\ndominantSpecies <- speciesDominanceIdentification(ABPSPtreeData)\n\n\n# working on AB PSP\nBCPSPtreeData <- BCPSPoutput$treeData\nBCPSPtreeData <- standardizeSpeciesName(BCPSPtreeData, forestInventorySource = \"BCPSP\")\n# nrow(ABPSPtreeData[newSpeciesName == \"unknown\",]) # 0\nBCPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\n# unique(BCPSPtreeData[Biomass==0,]$newSpeciesName)\n# [1] \"willow\"           \"mountain alder\"  \n# [3] \"fir\"              \"mountain hemlock\"\n# [5] \"scoulers willow\" \n# \nABPSPtreeData[newSpeciesName == \"limber pine\" | newSpeciesName == \"whitebark pine\",\n              newSpeciesName:=\"softwood\"]\n\nABPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\n\n\n\nSKPSPtreeData <- SKPSPoutput$treeData\nSKPSPtreeData <- standardizeSpeciesName(SKPSPtreeData, forestInventorySource = \"SKPSP\")\nnrow(SKPSPtreeData[newSpeciesName == \"unknown\",])\n# 4750\n\nunique(SKPSPtreeData[newSpeciesName == \"unknown\",]$Species)\n# \"XX\" \"\"\n\nSKPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\n\nunique(SKPSPtreeData[Biomass==0,]$newSpeciesName)\nrange(SKPSPtreeData$DBH) # NA\nSKPSPtreeData <- SKPSPtreeData[!is.na(DBH) & DBH != 0,] # need to fix this bug\n\nSKPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\n\nunique(SKPSPtreeData[Biomass==0,]$newSpeciesName)\n# [1] \"unknown\"        \"manitoba maple\"\n\n\nSKTSP_MistiktreeData <- SKTSP_Mistik_output$treeData\nSKTSP_MistiktreeData <- standardizeSpeciesName(SKTSP_MistiktreeData, forestInventorySource = \"SKTSP\")\n\nnrow(SKTSP_MistiktreeData[newSpeciesName == \"unknown\",])\n# 162\nunique(SKTSP_MistiktreeData[newSpeciesName == \"unknown\",]$Species)\n# [1] \"DC\" \"\"   \"DD\"\n\nSKTSP_MistiktreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\nunique(SKTSP_MistiktreeData[Biomass==0,]$newSpeciesName)\n# unknown\n\n\nSKTSP_PPPAtreeData <- SKTSP_PPPA_output$treeData\nSKTSP_PPPAtreeData <- standardizeSpeciesName(SKTSP_PPPAtreeData, forestInventorySource = \"SKTSP\")\n\nnrow(SKTSP_PPPAtreeData[newSpeciesName == \"unknown\",])\n# 0\n\nSKTSP_PPPAtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\nunique(SKTSP_PPPAtreeData[Biomass==0,]$newSpeciesName)\n# [1] \"manitoba maple\" \"green ash\"  \n\nNFIPSPtreeData <- NFIPSPoutput$treeData\nNFIPSPtreeData <- standardizeSpeciesName(NFIPSPtreeData, forestInventorySource = \"NFIPSP\")\n\nnrow(NFIPSPtreeData[newSpeciesName == \"unknown\",])\n# 6\nunique(NFIPSPtreeData[newSpeciesName == \"unknown\",]$Genus) # UNKN SPP\n\nNFIPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\nunique(NFIPSPtreeData[Biomass==0,]$newSpeciesName)\n# [1] \"scouler willow\" \"birch\"         \n# [3] \"willow\"         \"alder\"         \n# [5] \"unknown\"        \"poplar\"        \n# [7] \"bur oak\"\n\n\nMBPSPtreeData <- MBPSPoutput$treeData\nMBPSPtreeData <- standardizeSpeciesName(MBPSPtreeData, forestInventorySource = \"MBPSP\")\n\nnrow(MBPSPtreeData[newSpeciesName == \"unknown\",])\n# 25945\n\nunique(MBPSPtreeData[newSpeciesName == \"unknown\",]$Species)\n# [1] \"\"   \"WE\"\n\nMBPSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\nunique(MBPSPtreeData[Biomass==0,]$newSpeciesName)\n# [1] \"unknown\"        \"back ash\"      \n# [3] \"manitoba maple\" \"white oak\"\n\n\nMBTSPtreeData <- MBTSPoutput$treeData\nMBTSPtreeData <- standardizeSpeciesName(MBTSPtreeData, forestInventorySource = \"MBTSP\")\n\nnrow(MBTSPtreeData[newSpeciesName == \"unknown\",])\n# 1733\n\nunique(MBTSPtreeData[newSpeciesName == \"unknown\",]$Species) # need to fix this bug\n# [1] \"DC\"  \"\"    \"DD\"  \"ta\"  \"ba\"  \"ws\"  \"bs\" \n# [8] \"tl\"  \"bf\"  \"AE\"  \"GA\"  \" BS\" \"BW\"  \"jp\" \n# [15] \"wb\"\n\nMBTSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\nunique(MBTSPtreeData[Biomass==0,]$newSpeciesName)\n# [1] \"unknown\"        \"back ash\"      \n# [3] \"manitoba maple\" \"white oak\"\n\nNWTTSPtreeData <- NWTTSPoutput$treeData\nNWTTSPtreeData <- standardizeSpeciesName(NWTTSPtreeData, forestInventorySource = \"NWTTSP\")\n\nnrow(NWTTSPtreeData[newSpeciesName == \"unknown\",])\n# 0\n\nNWTTSPtreeData <- NWTTSPtreeData[!is.na(DBH) & DBH != 0,] # need to fix this bug\n\nNWTTSPtreeData[, Biomass:=biomassCalculation(species = newSpeciesName, DBH = DBH)$biomass]\nunique(NWTTSPtreeData[Biomass==0,]$newSpeciesName) # willow\nrange(NWTTSPtreeData$DBH) # NA NA\n\n\n",
    "created" : 1461733608608.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2136113564",
    "id" : "91ECC319",
    "lastKnownWriteTime" : 1461742123,
    "path" : "~/GitHub/landwebNRV/plotlevelBiomassProcess.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}