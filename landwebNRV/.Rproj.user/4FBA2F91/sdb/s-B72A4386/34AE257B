{
    "contents" : "################################################################################\n#' this function is to calculate aboveground biomass for boreal species based on DBH\n#' or DBH and Height\n#' \n#' @param species  Character string. The species name.\n#'\n#' @param DBH  Numeric. The tree's diameter at breast height (DBH, cm).\n#' \n#' @param heightIncluded  Logical. Whether the biomass is calculated based on DBH and height.\n#'        If TURE, height must be provided.\n#'        Default \\code{FALSE}\n#' \n#' @param height  Numeric. The tree's height (m).\n#' \n#' @param paperSource  Character. Determine the sources of equations. Currently, this functions has two\n#'        options, i.e., \"Lambert2005\" and \"Ung2008\".\n#'        Default \\code{Lambert2005}\n#'\n#' @return Biomass (kg) and missedSpecies list that was not calculated.\n#'\n#' @note no note\n#'\n#' @seealso no\n#'\n#' @include simList-class.R\n#' @export\n#' @docType methods\n#' @rdname biomassCalculation\n#'\n#' @author Yong Luo\n#'\n#' @examples\n#' \\dontrun{\n#'  DBH <- seq(1, 100, 5)\n#'  species <- c(rep(\"jack pine\", 10), rep(\"black spruce\", 10))\n#'  species[1] <- \"wrongSpecies\"\n#'  height <- seq(20, 40, length = 20)\n#'  biomass1 <- biomassCalculation(species = species, DBH = DBH) # without height information and\n#'                                                              # and taking the eqations from Lambert 2005\n#'                                                              \n#'  biomass2 <- biomassCalculation(species = species, DBH = DBH, heightIncluded = TRUE, height = height)\n#'                                                              # with height information and\n#'                                                              # and taking the eqations from Lambert 2005\n#' }\nsetGeneric(\"biomassCalculation\", function(species, DBH, heightIncluded, \n                                          height, paperSource) {\n  standardGeneric(\"biomassCalculation\")\n})\n\n#' @export\n#' @rdname moduleCoverage\nsetMethod(\n  \"biomassCalculation\",\n  signature = c(species = \"character\", DBH = \"numeric\", heightIncluded = \"logical\",\n                height = \"numeric\", paperSource = \"character\"),\n  definition = function(species, DBH, heightIncluded, \n                        height, paperSource) {\n    if(paperSource != \"Lambert2005\" & paperSource != \"Ung2008\"){\n      stop(\"Please select the correct paperSource Lambert2005 or Ung2008\")\n    }\n    \n    # the below parameters are from Table 3 in Lambert 2005\n    if(!heightIncluded){\n      tempdatatable <- data.table::data.table(species = species, DBH = DBH)\n      uniqueSpecies <- unique(species)\n      for (individualSpecies in uniqueSpecies){\n        if(individualSpecies == \"alpine fir\"){\n          wood1 <- 0.0528\n          wood2 <- 2.4309\n          bark1 <- 0.0108\n          bark2 <- 2.3876\n          branches1 <- 0.0121\n          branches2 <- 2.3519\n          foliage1 <- 0.0251\n          foliage2 <- 2.0389\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"balsam fir\"){\n          wood1 <- 0.0534\n          wood2 <- 2.4030\n          bark1 <- 0.0115\n          bark2 <- 2.3484\n          branches1 <- 0.0070\n          branches2 <- 2.5406\n          foliage1 <- 0.0840\n          foliage2 <- 1.6695\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"balsam poplar\"){\n          wood1 <- 0.0510\n          wood2 <- 2.4529\n          bark1 <- 0.0297\n          bark2 <- 2.1131\n          branches1 <- 0.0120\n          branches2 <- 2.4165\n          foliage1 <- 0.0276\n          foliage2 <- 1.6215\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n          \n        } else if (individualSpecies == \"basswood\"){\n          wood1 = 0.0562\n          wood2 <- 2.4102\n          bark1 <- 0.0302\n          bark2 <- 2.0976\n          branches1 <- 0.0230\n          branches2 <- 2.2382\n          foliage1 <- 0.0288\n          foliage2 <- 1.6378\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if(individualSpecies == \"black ash\"){\n          wood1 <- 0.0941\n          wood2 <- 2.3491\n          bark1 <- 0.0323\n          bark2 <- 2.0761\n          branches1 <- 0.0448\n          branches2 <- 1.9771\n          foliage1 <- 0.0538\n          foliage2 <- 1.3584\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"black cherry\"){\n          wood1 <- 0.3743\n          wood2 <- 1.9406\n          bark1 <- 0.0679\n          bark2 <- 1.8377\n          branches1 <- 0.0796\n          branches2 <- 2.0103\n          foliage1 <- 0.0840\n          foliage2 <- 1.2319\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"black spruce\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0477\n            wood2 <- 2.5147\n            bark1 <- 0.0153\n            bark2 <- 2.2429\n            branches1 <- 0.0278\n            branches2 <- 2.0839\n            foliage1 <- 0.1648\n            foliage2 <- 1.4143\n          } else {\n            wood1 <- 0.0494\n            wood2 <- 2.5025\n            bark1 <- 0.0148\n            bark2 <- 2.2494\n            branches1 <- 0.0291\n            branches2 <- 2.0751\n            foliage1 <- 0.1631\n            foliage2 <- 1.4222\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"douglas-fir\"){\n          wood1 <- 0.0204\n          wood2 <- 2.6974\n          bark1 <- 0.0069\n          bark2 <- 2.5462\n          branches1 <- 0.0404\n          branches2 <- 2.1388\n          foliage1 <- 0.1233\n          foliage2 <- 1.6636\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"engelmann spruce\"){\n          wood1 <- 0.0223\n          wood2 <- 2.7169\n          bark1 <- 0.0118\n          bark2 <- 2.2733\n          branches1 <- 0.0336\n          branches2 <- 2.2123\n          foliage1 <- 0.0683\n          foliage2 <- 1.8022\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"eastern hemlock\"){\n          wood1 <- 0.0619\n          wood2 <- 2.3821\n          bark1 <- 0.0139\n          bark2 <- 2.3282\n          branches1 <- 0.0217\n          branches2 <- 2.2653\n          foliage1 <- 0.0776\n          foliage2 <- 1.6995\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"eastern redcedar\"){\n          wood1 <- 0.1277\n          wood2 <- 1.9778\n          bark1 <- 0.0377\n          bark2 <- 1.6064\n          branches1 <- 0.0254\n          branches2 <- 2.2884\n          foliage1 <- 0.0550\n          foliage2 <- 1.8656\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"eastern white-cedar\"){\n          wood1 <- 0.0654\n          wood2 <- 2.2121\n          bark1 <- 0.0114\n          bark2 <- 2.1432\n          branches1 <- 0.0335\n          branches2 <- 1.9367\n          foliage1 <- 0.0499\n          foliage2 <- 1.7278\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"eastern white pine\"){\n          wood1 <- 0.0997\n          wood2 <- 2.2709\n          bark1 <- 0.0192\n          bark2 <- 2.2038\n          branches1 <- 0.0056\n          branches2 <- 2.6011\n          foliage1 <- 0.0284\n          foliage2 <- 1.9375\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"grey birch\"){\n          wood1 <- 0.0720\n          wood2 <- 2.3885\n          bark1 <- 0.0168\n          bark2 <- 2.2569\n          branches1 <- 0.0088\n          branches2 <- 2.5689\n          foliage1 <- 0.0099\n          foliage2 <- 1.8985\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"hickory\"){\n          wood1 <- 0.2116\n          wood2 <- 2.2013\n          bark1 <- 0.0365\n          bark2 <- 2.1133\n          branches1 <- 0.0087\n          branches2 <- 2.8927\n          foliage1 <- 0.0173\n          foliage2 <- 1.9830\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"hop-hornbeam\"){\n          wood1 <- 0.1929\n          wood2 <- 1.9672\n          bark1 <- 0.0671\n          bark2 <- 1.5911\n          branches1 <- 0.0278\n          branches2 <- 2.1336\n          foliage1 <- 0.0293\n          foliage2 <- 1.9502\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"jack pine\"){\n          wood1 <- 0.0804\n          wood2 <- 2.4041\n          bark1 <- 0.0184\n          bark2 <- 2.0703\n          branches1 <- 0.0079\n          branches2 <- 2.4155\n          foliage1 <- 0.0389\n          foliage2 <- 1.7290\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"largetooth aspen\"){\n          wood1 <- 0.0959\n          wood2 <- 2.3430\n          bark1 <- 0.0308\n          bark2 <- 2.2240\n          branches1 <- 0.0047\n          branches2 <- 2.6530\n          foliage1 <- 0.0080\n          foliage2 <- 2.0149\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"lodgepole pine\"){\n          if(paperSource == Lambert2005){\n            wood1 <- 0.0475\n            wood2 <- 2.5437\n            bark1 <- 0.0186\n            bark2 <- 2.0807\n            branches1 <- 0.0198\n            branches2 <- 2.1287\n            foliage1 <- 0.0432\n            foliage2 <- 1.7166 \n          } else {\n            wood1 <- 0.0323\n            wood2 <- 2.6825\n            bark1 <- 0.0144\n            bark2 <- 2.1768\n            branches1 <- 0.0209\n            branches2 <- 2.1772\n            foliage1 <- 0.0584\n            foliage2 <- 1.6432\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if(individualSpecies == \"pacific silver fir\"){\n          wood1 <- 0.0424\n          wood2 <- 2.4289\n          bark1 <- 0.0057\n          bark2 <- 2.4786\n          branches1 <- 0.0322\n          branches2 <- 2.1313\n          foliage1 <- 0.0645\n          foliage2 <- 1.9400\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if(individualSpecies == \"red alder\" | individualSpecies == \"black cottonwood\"){\n          wood1 <- 0.0460\n          wood2 <- 2.4312\n          bark1 <- 0.0074\n          bark2 <- 2.4442\n          branches1 <- 0.0086\n          branches2 <- 2.7326\n          foliage1 <- 0.0114\n          foliage2 <- 2.0860\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if(individualSpecies == \"red ash\"){\n          wood1 <- 0.1571\n          wood2 <- 2.1817\n          bark1 <- 0.0416\n          bark2 <- 2.0509\n          branches1 <- 0.0177\n          branches2 <- 2.3370\n          foliage1 <- 0.1041\n          foliage2 <- 1.2185\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"red maple\"){\n          wood1 <- 0.1014\n          wood2 <- 2.3448\n          bark1 <- 0.0291\n          bark2 <- 2.0893\n          branches1 <- 0.0175\n          branches2 <- 2.4846\n          foliage1 <- 0.0515\n          foliage2 <- 1.5198\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"red oak\"){\n          wood1 <- 0.1754\n          wood2 <- 2.1616\n          bark1 <- 0.0381\n          bark2 <- 2.0991\n          branches1 <- 0.0085\n          branches2 <- 2.7790\n          foliage1 <- 0.0373\n          foliage2 <- 1.6740\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"red pine\"){\n          wood1 <- 0.0564\n          wood2 <- 2.4465\n          bark1 <- 0.0188\n          bark2 <- 2.0527\n          branches1 <- 0.0033\n          branches2 <- 2.7515\n          foliage1 <- 0.0212\n          foliage2 <- 2.0690\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"red spruce\"){\n          wood1 <- 0.0989\n          wood2 <- 2.2814\n          bark1 <- 0.0220\n          bark2 <- 2.0908\n          branches1 <- 0.0005\n          branches2 <- 3.2750\n          foliage1 <- 0.0066\n          foliage2 <- 2.4213\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"sitka spruce\"){\n          wood1 <- 0.0302\n          wood2 <- 2.5776\n          bark1 <- 0.0066\n          bark2 <- 2.4433\n          branches1 <- 0.0739\n          branches2 <- 1.8342\n          foliage1 <- 0.0157\n          foliage2 <- 2.3113\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"subalpine fir\"){\n          wood1 <- 0.0250\n          wood2 <- 2.6378\n          bark1 <- 0.0061\n          bark2 <- 2.5375\n          branches1 <- 0.0178\n          branches2 <- 2.4255\n          foliage1 <- 0.0416\n          foliage2 <- 2.0130\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"silver maple\"){\n          wood1 <- 0.2324\n          wood2 <- 2.1000\n          bark1 <- 0.0278\n          bark2 <- 2.0433\n          branches1 <- 0.0028\n          branches2 <- 3.1020\n          foliage1 <- 0.1430\n          foliage2 <- 1.2580\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"sugar maple\"){\n          wood1 <- 0.1315\n          wood2 <- 2.3129\n          bark1 <- 0.0631\n          bark2 <- 1.9241\n          branches1 <- 0.0330\n          branches2 <- 2.3741\n          foliage1 <- 0.0393\n          foliage2 <- 1.6930\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"tamarack larch\"){\n          wood1 <- 0.0625\n          wood2 <- 2.4475\n          bark1 <- 0.0174\n          bark2 <- 2.1109\n          branches1 <- 0.0196\n          branches2 <- 2.2652\n          foliage1 <- 0.0801\n          foliage2 <- 1.4875\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"trembling aspen\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0605\n            wood2 <- 2.4750\n            bark1 <- 0.0168\n            bark2 <- 2.3949\n            branches1 <- 0.0080\n            branches2 <- 2.5214\n            foliage1 <- 0.0261\n            foliage2 <- 1.6304\n          } else {\n            wood1 <- 0.0608\n            wood2 <- 2.4735\n            bark1 <- 0.0159\n            bark2 <- 2.4123\n            branches1 <- 0.0082\n            branches2 <- 2.5139\n            foliage1 <- 0.0235\n            foliage2 <- 1.6656\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"western hemlock\"){\n          wood1 <- 0.0141\n          wood2 <- 2.8668\n          bark1 <- 0.0025\n          bark2 <- 2.8062\n          branches1 <- 0.0703\n          branches2 <- 1.9547\n          foliage1 <- 0.1676\n          foliage2 <- 1.4339\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"western redcedar\"){\n          wood1 <- 0.0111\n          wood2 <- 2.8027\n          bark1 <- 0.0003\n          bark2 <- 3.2721\n          branches1 <- 0.1158\n          branches2 <- 1.7196\n          foliage1 <- 0.1233\n          foliage2 <- 1.5152\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"white ash\"){\n          wood1 <- 0.1861\n          wood2 <- 2.1665\n          bark1 <- 0.0406\n          bark2 <- 1.9946\n          branches1 <- 0.0461\n          branches2 <- 2.2291\n          foliage1 <- 0.1106\n          foliage2 <- 1.2277\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"white birch\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0593\n            wood2 <- 2.5026\n            bark1 <- 0.0135\n            bark2 <- 2.4053\n            branches1 <- 0.0135\n            branches2 <- 2.5532\n            foliage1 <- 0.0546\n            foliage2 <- 1.6351\n          } else {\n            wood1 <- 0.0604\n            wood2 <- 2.4959\n            bark1 <- 0.0140\n            bark2 <- 2.3923\n            branches1 <- 0.0147\n            branches2 <- 2.5227\n            foliage1 <- 0.0591\n            foliage2 <- 1.6036\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"white elm\"){\n          wood1 <- 0.0402\n          wood2 <- 2.5804\n          bark1 <- 0.0073\n          bark2 <- 2.4859\n          branches1 <- 0.0401\n          branches2 <- 2.1826\n          foliage1 <- 0.0750\n          foliage2 <- 1.3436\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"white spruce\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0359\n            wood2 <- 2.5775\n            bark1 <- 0.0116\n            bark2 <- 2.3022\n            branches1 <- 0.0283\n            branches2 <- 2.0823\n            foliage1 <- 0.1601\n            foliage2 <- 1.4670\n          } else {\n            wood1 <- 0.0334\n            wood2 <- 2.5980\n            bark1 <- 0.0114\n            bark2 <- 2.3057\n            branches1 <- 0.0302\n            branches2 <- 2.0927\n            foliage1 <- 0.1515\n            foliage2 <- 1.5012\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"yellow birch\"){\n          wood1 <- 0.1932\n          wood2 <- 2.1569\n          bark1 <- 0.0192\n          bark2 <- 2.2475\n          branches1 <- 0.0305\n          branches2 <- 2.4044\n          foliage1 <- 0.1119\n          foliage2 <- 1.3973\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"hardwood\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0871\n            wood2 <- 2.3702\n            bark1 <- 0.0241\n            bark2 <- 2.1969\n            branches1 <- 0.0167\n            branches2 <- 2.4807\n            foliage1 <- 0.0390\n            foliage2 <- 1.6229\n          } else {\n            wood1 <- 0.0864\n            wood2 <- 2.3715\n            bark1 <- 0.0226\n            bark2 <- 2.2151\n            branches1 <- 0.0186\n            branches2 <- 2.4462\n            foliage1 <- 0.0385\n            foliage2 <- 1.6255\n          }\n          \n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else if (individualSpecies == \"softwood\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0648\n            wood2 <- 2.3927\n            bark1 <- 0.0162\n            bark2 <- 2.1959\n            branches1 <- 0.0156\n            branches2 <- 2.2916\n            foliage1 <- 0.0861\n            foliage2 <- 1.6261\n          } else {\n            wood1 <- 0.0564\n            wood2 <- 2.4347\n            bark1 <- 0.0153\n            bark2 <- 2.2110\n            branches1 <- 0.0194\n            branches2 <- 2.2408\n            foliage1 <- 0.0935\n            foliage2 <- 1.6106\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*DBH^wood2+\n                          bark1*DBH^bark2+\n                          foliage1*DBH^foliage2+\n                          branches1*DBH^branches2]\n        } else {\n          tempdatatable[species == individualSpecies,\n                        biomass := 0]\n        }\n      }\n      \n    } else {\n      tempdatatable <- data.table::data.table(species = species,\n                                              DBH = DBH,\n                                              height = height)\n      uniqueSpecies <- unique(species)\n      for (individualSpecies in uniqueSpecies){\n        if(individualSpecies == \"alpine fir\"){\n          wood1 <- 0.0268\n          wood2 <- 1.7579\n          wood3 <- 0.9871\n          bark1 <- 0.0009\n          bark2 <- 1.4460\n          bark3 <- 1.8839\n          branches1 <- 0.0470\n          branches2 <- 2.9288\n          branches3 <- -1.1588\n          foliage1 <- 0.0551\n          foliage2 <- 1.7585\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"balsam fir\"){\n          wood1 <- 0.0294\n          wood2 <- 1.8357\n          wood3 <- 0.8640\n          bark1 <- 0.0053\n          bark2 <- 2.0876\n          bark3 <- 0.5842\n          branches1 <- 0.0117\n          branches2 <- 3.5097\n          branches3 <- -1.3006\n          foliage1 <- 0.1245\n          foliage2 <- 2.5230\n          foliage3 <- -1.1230\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"balsam poplar\"){\n          wood1 <- 0.0117\n          wood2 <- 1.7757\n          wood3 <- 1.2555\n          bark1 <- 0.0180\n          bark2 <- 1.8131\n          bark3 <- 0.5144\n          branches1 <- 0.0112\n          branches2 <- 3.0861\n          branches3 <- -0.7164\n          foliage1 <- 0.0617\n          foliage2 <- 1.8615\n          foliage3 <- -0.5375\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"basswood\"){\n          wood1 <- 0.0168\n          wood2 <- 1.9844\n          wood3 <- 0.8989\n          bark1 <- 0.0057\n          bark2 <- 1.5881\n          bark3 <- 1.1472\n          branches1 <- 0.0039\n          branches2 <- 2.0084\n          branches3 <- 0.8588\n          foliage1 <- 0.0147\n          foliage2 <- 1.8300\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"beech\"){\n          wood1 <- 0.0432\n          wood2 <- 2.0378\n          wood3 <- 0.7000\n          bark1 <- 0.0049\n          bark2 <- 1.9057\n          bark3 <- 0.6770\n          branches1 <- 0.0355\n          branches2 <- 2.3749\n          branches3 <- 0\n          foliage1 <- 0.0452\n          foliage2 <- 1.5567\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"black ash\"){\n          wood1 <- 0.0306\n          wood2 <- 2.1836\n          wood3 <- 0.5740\n          bark1 <- 0.0897\n          bark2 <- 2.2634\n          bark3 <- -0.5670\n          branches1 <- 0.0994\n          branches2 <- 2.1630\n          branches3 <- -0.4809\n          foliage1 <- 0.0124\n          foliage2 <- 1.0325\n          foliage3 <- 0.8747\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"black cherry\"){\n          wood1 <- 0.0181\n          wood2 <- 1.7013\n          wood3 <- 1.3057\n          bark1 <- 0.0101\n          bark2 <- 1.5956\n          bark3 <- 0.9190\n          branches1 <- 0.0005\n          branches2 <- 2.8004\n          branches3 <- 0.8603\n          foliage1 <- 0.1976\n          foliage2 <- 1.4421\n          foliage3 <- -0.5264\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"black spruce\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0309\n            wood2 <- 1.7527\n            wood3 <- 1.0014\n            bark1 <- 0.0115\n            bark2 <- 1.7405\n            bark3 <- 0.6589\n            branches1 <- 0.0380\n            branches2 <- 3.2558\n            branches3 <- -1.4218\n            foliage1 <- 0.2048\n            foliage2 <- 2.5754\n            foliage3 <- -1.3704\n          } else {\n            wood1 <- 0.0335\n            wood2 <- 1.7389\n            wood3 <- 0.9835\n            bark1 <- 0.0132\n            bark2 <- 1.7657\n            bark3 <- 0.5775\n            branches1 <- 0.0405\n            branches2 <- 3.1917\n            branches3 <- -1.3674\n            foliage1 <- 0.2078\n            foliage2 <- 2.5517\n            foliage3 <- -1.3453\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"douglas-fir\"){\n          wood1 <- 0.0191\n          wood2 <- 1.5365\n          wood3 <- 1.3634\n          bark1 <- 0.0083\n          bark2 <- 2.4811\n          bark3 <- 0\n          branches1 <- 0.0351\n          branches2 <- 2.2421\n          branches3 <- 0\n          foliage1 <- 0.0718\n          foliage2 <- 2.2935\n          foliage3 <- -0.4744\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"engelmann spruce\"){\n          wood1 <- 0.0133\n          wood2 <- 1.3303\n          wood3 <- 1.6877\n          bark1 <- 0.0086\n          bark2 <- 1.6216\n          bark3 <- 0.8192\n          branches1 <- 0.0428\n          branches2 <- 2.7965\n          branches3 <- -0.7328\n          foliage1 <- 0.0854\n          foliage2 <- 2.4388\n          foliage3 <- -0.7630\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"eastern hemlock\"){\n          wood1 <- 0.0257\n          wood2 <- 1.9277\n          wood3 <- 0.8576\n          bark1 <- 0.0118\n          bark2 <- 1.9893\n          bark3 <- 0.4700\n          branches1 <- 0.0215\n          branches2 <- 2.6553\n          branches3 <- -0.4682\n          foliage1 <- 0.1471\n          foliage2 <- 2.0108\n          foliage3 <- -0.6080\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"eastern redcedar\"){\n          wood1 <- 0.0520\n          wood2 <- 1.7731\n          wood3 <- 0.7054\n          bark1 <- 0.0283\n          bark2 <- 1.7079\n          bark3 <- 0\n          branches1 <- 0.0219\n          branches2 <- 2.3585\n          branches3 <- 0\n          foliage1 <- 0.2575\n          foliage2 <- 2.5136\n          foliage3 <- -1.5565\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"eastern white-cedar\"){\n          wood1 <- 0.0295\n          wood2 <- 1.7026\n          wood3 <- 0.9428\n          bark1 <- 0.0076\n          bark2 <- 1.7861\n          bark3 <- 0.6132\n          branches1 <- 0.0501\n          branches2 <- 2.5165\n          branches3 <- -0.8774\n          foliage1 <- 0.0813\n          foliage2 <- 2.2180\n          foliage3 <- -0.7907\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"eastern white pine\"){\n          wood1 <- 0.0170\n          wood2 <- 1.7779\n          wood3 <- 1.1370\n          bark1 <- 0.0069\n          bark2 <- 1.6589\n          bark3 <- 0.9582\n          branches1 <- 0.0184\n          branches2 <- 3.1968\n          branches3 <- -1.0876\n          foliage1 <- 0.0584\n          foliage2 <- 2.2389\n          foliage3 <- -0.5968\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"grey birch\"){\n          wood1 <- 0.0295\n          wood2 <- 1.9064\n          wood3 <- 0.9139\n          bark1 <- 0.0148\n          bark2 <- 1.8433\n          bark3 <- 0.5021\n          branches1 <- 0.0150\n          branches2 <- 3.0347\n          branches3 <- -0.7629\n          foliage1 <- 0.0455\n          foliage2 <- 2.6447\n          foliage3 <- -1.4955\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"hickory\"){\n          wood1 <- 0.0139\n          wood2 <- 1.5913\n          wood3 <- 1.5080\n          bark1 <- 0.0081\n          bark2 <- 1.4943\n          bark3 <- 1.1324\n          branches1 <- 0.0050\n          branches2 <- 3.0463\n          branches3 <- 0\n          foliage1 <- 0.0121\n          foliage2 <- 2.0865\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"hop-hornbeam\"){\n          wood1 <- 0.0083\n          wood2 <- 1.6534\n          wood3 <- 1.7479\n          bark1 <- 0.0012\n          bark2 <- 1.1486\n          bark3 <- 2.2903\n          branches1 <- 0.0009\n          branches2 <- 1.9152\n          branches3 <- 1.7769\n          foliage1 <- 0.0247\n          foliage2 <- 2.0056\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"jack pine\"){\n          wood1 <- 0.0199\n          wood2 <- 1.6883\n          wood3 <- 1.2456\n          bark1 <- 0.0141\n          bark2 <- 1.5994\n          bark3 <- 0.5957\n          branches1 <- 0.0185\n          branches2 <- 3.0584\n          branches3 <- -0.9816\n          foliage1 <- 0.0325\n          foliage2 <- 1.7879\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"largetooth aspen\"){\n          wood1 <- 0.0128\n          wood2 <- 2.0633\n          wood3 <- 0.9516\n          bark1 <- 0.0240\n          bark2 <- 2.3055\n          bark3 <- 0\n          branches1 <- 0.0131\n          branches2 <- 3.1274\n          branches3 <- -0.8379\n          foliage1 <- 0.0382\n          foliage2 <- 2.1673\n          foliage3 <- -0.6842\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"lodgepole pine\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0202\n            wood2 <- 1.7179\n            wood3 <- 1.2078\n            bark1 <- 0.0099\n            bark2 <- 1.6049\n            bark3 <- 0.7456\n            branches1 <- 0.0440\n            branches2 <- 3.7190\n            branches3 <- -2.0399\n            foliage1 <- 0.0785\n            foliage2 <- 2.5377\n            foliage3 <- -1.1213\n          } else {\n            wood1 <- 0.0239\n            wood2 <- 1.6827\n            wood3 <- 1.1878\n            bark1 <- 0.0117\n            bark2 <- 1.6398\n            bark3 <- 0.6524\n            branches1 <- 0.0285\n            branches2 <- 3.3764\n            branches3 <- -1.4395\n            foliage1 <- 0.0769\n            foliage2 <- 2.6834\n            foliage3 <- -1.2484\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"pacific silver fir\"){\n          wood1 <- 0.0315\n          wood2 <- 1.8297\n          wood3 <- 0.8056\n          bark1 <- 0.0067\n          bark2 <- 2.6970\n          bark3 <- -0.3105\n          branches1 <- 0.0420\n          branches2 <- 2.0313\n          branches3 <- 0\n          foliage1 <- 0.0453\n          foliage2 <- 2.4867\n          foliage3 <- -0.4982\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"red alder\" | individualSpecies == \"black cottonwood\"){\n          wood1 <- 0.0051\n          wood2 <- 1.0697\n          wood3 <- 2.2748\n          bark1 <- 0.0009\n          bark2 <- 1.3061\n          bark3 <- 2.0109\n          branches1 <- 0.0131\n          branches2 <- 2.5760\n          branches3 <- 0\n          foliage1 <- 0.0224\n          foliage2 <- 1.8368\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"red ash\"){\n          wood1 <- 0.0224\n          wood2 <- 1.7845\n          wood3 <- 1.0600\n          bark1 <- 0.0219\n          bark2 <- 1.4190\n          bark3 <- 0.8963\n          branches1 <- 0.0176\n          branches2 <- 2.3313\n          branches3 <- 0\n          foliage1 <- 0.0761\n          foliage2 <- 1.3077\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"red maple\"){\n          wood1 <- 0.0315\n          wood2 <- 2.0342\n          wood3 <- 0.7485\n          bark1 <- 0.0283\n          bark2 <- 2.0907\n          bark3 <- 0\n          branches1 <- 0.0225\n          branches2 <- 2.4106\n          branches3 <- 0\n          foliage1 <- 0.0571\n          foliage2 <- 1.4898\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"red oak\"){\n          wood1 <- 0.0285\n          wood2 <- 1.8501\n          wood3 <- 1.0204\n          bark1 <- 0.0326\n          bark2 <- 1.8100\n          bark3 <- 0.4153\n          branches1 <- 0.0013\n          branches2 <- 3.0637\n          branches3 <- 0.3153\n          foliage1 <- 0.0582\n          foliage2 <- 1.5438\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"red pine\"){\n          wood1 <- 0.0106\n          wood2 <- 1.7725\n          wood3 <- 1.3285\n          bark1 <- 0.0277\n          bark2 <- 1.5192\n          bark3 <- 0.4645\n          branches1 <- 0.0125\n          branches2 <- 3.3865\n          branches3 <- -1.1939\n          foliage1 <- 0.0731\n          foliage2 <- 2.3439\n          foliage3 <- -0.7378\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"red spruce\"){\n          wood1 <- 0.0143\n          wood2 <- 1.6441\n          wood3 <- 1.4065\n          bark1 <- 0.0274\n          bark2 <- 2.0188\n          bark3 <- 0\n          branches1 <- 0.0005\n          branches2 <- 3.3136\n          branches3 <- 0\n          foliage1 <- 0.0106\n          foliage2 <- 2.2709\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"sitka spruce\"){\n          wood1 <- 0.0237\n          wood2 <- 2.5813\n          wood3 <- 0.0822\n          bark1 <- 0.0045\n          bark2 <- 1.2275\n          bark3 <- 1.5190\n          branches1 <- 0.0498\n          branches2 <- 1.9671\n          branches3 <- 0\n          foliage1 <- 0.0140\n          foliage2 <- 3.1305\n          foliage3 <- -0.9070\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"subalpine fir\"){\n          wood1 <- 0.0220\n          wood2 <- 1.6469\n          wood3 <- 1.1714\n          bark1 <- 0.0061\n          bark2 <- 1.8603\n          bark3 <- 0.7693\n          branches1 <- 0.0265\n          branches2 <- 3.6747\n          branches3 <- -1.5958\n          foliage1 <- 0.0509\n          foliage2 <- 2.9909\n          foliage3 <- -1.2271\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"silver maple\"){\n          wood1 <- 0.0274\n          wood2 <- 1.7126\n          wood3 <- 1.1086\n          bark1 <- 0.0123\n          bark2 <- 1.8250\n          bark3 <- 0.5010\n          branches1 <- 0.0543\n          branches2 <- 3.7343\n          branches3 <- -1.6497\n          foliage1 <- 6.6808\n          foliage2 <- 2.1092\n          foliage3 <- -2.1697\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"sugar maple\"){\n          wood1 <- 0.0301\n          wood2 <- 2.0313\n          wood3 <- 0.8171\n          bark1 <- 0.0103\n          bark2 <- 1.7111\n          bark3 <- 0.8509\n          branches1 <- 0.0661\n          branches2 <- 2.5940\n          branches3 <- -0.4933\n          foliage1 <- 2.5019\n          foliage2 <- 2.4527\n          foliage3 <- -2.3008\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"tamarack larch\"){\n          wood1 <- 0.0276\n          wood2 <- 1.6724\n          wood3 <- 1.1443\n          bark1 <- 0.0120\n          bark2 <- 1.7059\n          bark3 <- 0.5811\n          branches1 <- 0.0336\n          branches2 <- 3.1335\n          branches3 <- -1.1559\n          foliage1 <- 0.1324\n          foliage2 <- 2.1140\n          foliage3 <- -0.8781\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"trembling aspen\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0142\n            wood2 <- 1.9389\n            wood3 <- 1.0572\n            bark1 <- 0.0063\n            bark2 <- 2.0819\n            bark3 <- 0.6617\n            branches1 <- 0.0137\n            branches2 <- 2.9270\n            branches3 <- -0.6221\n            foliage1 <- 0.0270\n            foliage2 <- 1.6183\n            foliage3 <- 0\n          } else {\n            wood1 <- 0.0143\n            wood2 <- 1.9369\n            wood3 <- 1.0579\n            bark1 <- 0.0063\n            bark2 <- 2.0744\n            bark3 <- 0.6691\n            branches1 <- 0.0150\n            branches2 <- 2.9068\n            branches3 <- -0.6306\n            foliage1 <- 0.0284\n            foliage2 <- 1.6020\n            foliage3 <- 0\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"western hemlock\"){\n          wood1 <- 0.0113\n          wood2 <- 1.9332\n          wood3 <- 1.1125\n          bark1 <- 0.0019\n          bark2 <- 2.3356\n          bark3 <- 0.6371\n          branches1 <- 0.0609\n          branches2 <- 2.0021\n          branches3 <- 0\n          foliage1 <- 0.2656\n          foliage2 <- 2.0107\n          foliage3 <- -0.7963\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"western redcedar\"){\n          wood1 <- 0.0188\n          wood2 <- 1.3376\n          wood3 <- 1.5293\n          bark1 <- 0.0002\n          bark2 <- 2.4369\n          bark3 <- 1.1315\n          branches1 <- 0.0611\n          branches2 <- 1.9208\n          branches3 <- 0\n          foliage1 <- 0.1097\n          foliage2 <- 1.5530\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"white ash\"){\n          wood1 <- 0.0224\n          wood2 <- 1.7438\n          wood3 <- 1.1899\n          bark1 <- 0.0126\n          bark2 <- 1.6456\n          bark3 <- 0.7893\n          branches1 <- 0.0354\n          branches2 <- 2.3046\n          branches3 <- 0\n          foliage1 <- 0.0195\n          foliage2 <- 1.0509\n          foliage3 <- 0.7836\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"white birch\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0338\n            wood2 <- 2.0702\n            wood3 <- 0.6876\n            bark1 <- 0.0080\n            bark2 <- 1.9754\n            bark3 <- 0.6659\n            branches1 <- 0.0257\n            branches2 <- 3.1754\n            branches3 <- -0.9417\n            foliage1 <- 0.1415\n            foliage2 <- 2.3074\n            foliage3 <- -1.1189 \n          } else {\n            wood1 <- 0.0333\n            wood2 <- 2.0794\n            wood3 <- 0.6811\n            bark1 <- 0.0079\n            bark2 <- 1.9905\n            bark3 <- 0.6553\n            branches1 <- 0.0253\n            branches2 <- 3.1518\n            branches3 <- -0.9083\n            foliage1 <- 0.1361\n            foliage2 <- 2.2978\n            foliage3 <- -1.0934\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"white elm\"){\n          wood1 <- 0.0207\n          wood2 <- 2.2276\n          wood3 <- 0.6488\n          bark1 <- 0.0078\n          bark2 <- 2.4540\n          bark3 <- 0\n          branches1 <- 0.0393\n          branches2 <- 2.1880\n          branches3 <- 0\n          foliage1 <- 0.0516\n          foliage2 <- 1.4511\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"white oak\"){\n          wood1 <- 0.0442\n          wood2 <- 1.6818\n          wood3 <- 1.0310\n          bark1 <- 0.0308\n          bark2 <- 1.7479\n          bark3 <- 0.3504\n          branches1 <- 0.0022\n          branches2 <- 2.0165\n          branches3 <- 1.3953\n          foliage1 <- 0.0053\n          foliage2 <- 1.2822\n          foliage3 <- 1.1323\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"white spruce\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0265\n            wood2 <- 1.7952\n            wood3 <- 0.9733\n            bark1 <- 0.0124\n            bark2 <- 1.6962\n            bark3 <- 0.6489\n            branches1 <- 0.0325\n            branches2 <- 2.8573\n            branches3 <- -0.9127\n            foliage1 <- 0.2020\n            foliage2 <- 2.3802\n            foliage3 <- -1.1103 \n          } else {\n            wood1 <- 0.0252\n            wood2 <- 1.7819\n            wood3 <- 1.0022\n            bark1 <- 0.0096\n            bark2 <- 1.6901\n            bark3 <- 0.7393\n            branches1 <- 0.0322\n            branches2 <- 2.8961\n            branches3 <- -0.9203\n            foliage1 <- 0.1832\n            foliage2 <- 2.4144\n            foliage3 <- -1.0948\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"yellow birch\"){\n          wood1 <- 0.0259\n          wood2 <- 1.9044\n          wood3 <- 0.9715\n          bark1 <- 0.0069\n          bark2 <- 2.0834\n          bark3 <- 0.5371\n          branches1 <- 0.0325\n          branches2 <- 2.3851\n          branches3 <- 0\n          foliage1 <- 0.1683\n          foliage2 <- 1.2764\n          foliage3 <- 0\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"hardwood\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0359\n            wood2 <- 2.0263\n            wood3 <- 0.6987\n            bark1 <- 0.0094\n            bark2 <- 1.8677\n            bark3 <- 0.6985\n            branches1 <- 0.0433\n            branches2 <- 2.6817\n            branches3 <- -0.5731\n            foliage1 <- 0.0859\n            foliage2 <- 1.8485\n            foliage3 <- -0.5383\n          } else {\n            wood1 <- 0.0353\n            wood2 <- 2.0249\n            wood3 <- 0.7048\n            bark1 <- 0.0090\n            bark2 <- 1.8677\n            bark3 <- 0.7144\n            branches1 <- 0.0448\n            branches2 <- 2.6855\n            branches3 <- -0.5911\n            foliage1 <- 0.0869\n            foliage2 <- 1.8541\n            foliage3 <- -0.5491\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else if(individualSpecies == \"softwood\"){\n          if(paperSource == \"Lambert2005\"){\n            wood1 <- 0.0284\n            wood2 <- 1.6894\n            wood3 <- 1.0857\n            bark1 <- 0.0100\n            bark2 <- 1.8463\n            bark3 <- 0.5616\n            branches1 <- 0.0301\n            branches2 <- 3.0038\n            branches3 <- -1.0520\n            foliage1 <- 0.1554\n            foliage2 <- 2.4021\n            foliage3 <- -1.1043\n          } else {\n            wood1 <- 0.0276\n            wood2 <- 1.6868\n            wood3 <- 1.0953\n            bark1 <- 0.0101\n            bark2 <- 1.8486\n            bark3 <- 0.5525\n            branches1 <- 0.0313\n            branches2 <- 2.9974\n            branches3 <- -1.0383\n            foliage1 <- 0.1379\n            foliage2 <- 2.3981\n            foliage3 <- -1.0418\n          }\n          tempdatatable[species == individualSpecies,\n                        biomass := wood1*(DBH^wood2)*(height^wood3)+\n                          bark1*(DBH^bark2)*(height^bark3)+\n                          foliage1*(DBH^foliage2)*(height^foliage3)+\n                          branches1*(DBH^branches2)*(height^branches3)]\n        } else {\n          tempdatatable[species == individualSpecies,\n                        biomass := 0]\n        }\n      }\n    }\n    \n    return(list(biomass = tempdatatable$biomass,\n                missedSpecies = unique(tempdatatable[biomass == 0,]$species)))\n  })\n\n#' @export\n#' @rdname biomassCalculation\nsetMethod(\n  \"biomassCalculation\",\n  signature = c(species = \"character\", DBH = \"numeric\", heightIncluded = \"missing\",\n                height = \"numeric\", paperSource = \"character\"),\n  definition = function(species, DBH, height, paperSource) {\n    biomassCalculation(species = species, DBH = DBH, heightIncluded = FALSE,\n                       height = height, paperSource = paperSource)\n  })\n\n#' @export\n#' @rdname biomassCalculation\nsetMethod(\n  \"biomassCalculation\",\n  signature = c(species = \"character\", DBH = \"numeric\", heightIncluded = \"logical\",\n                height = \"numeric\", paperSource = \"missing\"),\n  definition = function(species, DBH, heightIncluded, height) {\n    biomassCalculation(species = species, DBH = DBH, heightIncluded = heightIncluded,\n                       height = height, paperSource = \"Lambert2005\")\n  })\n\n#' @export\n#' @rdname biomassCalculation\nsetMethod(\n  \"biomassCalculation\",\n  signature = c(species = \"character\", DBH = \"numeric\", heightIncluded = \"missing\",\n                height = \"numeric\", paperSource = \"missing\"),\n  definition = function(species, DBH, height) {\n    biomassCalculation(species = species, DBH = DBH, heightIncluded = FALSE,\n                       height = height, paperSource = \"Lambert2005\")\n  })\n\n#' @export\n#' @rdname biomassCalculation\nsetMethod(\n  \"biomassCalculation\",\n  signature = c(species = \"character\", DBH = \"numeric\", heightIncluded = \"missing\",\n                height = \"missing\", paperSource = \"character\"),\n  definition = function(species, DBH, paperSource) {\n    biomassCalculation(species = species, DBH = DBH, heightIncluded = FALSE,\n                       height = 1, paperSource = paperSource)\n  })\n\n#' @export\n#' @rdname biomassCalculation\nsetMethod(\n  \"biomassCalculation\",\n  signature = c(species = \"character\", DBH = \"numeric\", heightIncluded = \"missing\",\n                height = \"missing\", paperSource = \"missing\"),\n  definition = function(species, DBH) {\n    biomassCalculation(species = species, DBH = DBH, heightIncluded = FALSE,\n                       height = 1, paperSource = \"Lambert2005\")\n  })\n",
    "created" : 1460675552436.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3687734394",
    "id" : "34AE257B",
    "lastKnownWriteTime" : 1460675454,
    "path" : "~/GitHub/landwebNRV/landwebNRV/R/biomassCalculation.R",
    "project_path" : "R/biomassCalculation.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}